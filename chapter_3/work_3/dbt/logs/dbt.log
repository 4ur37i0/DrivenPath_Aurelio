[0m03:13:38.317544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5be0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a6b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a6a990>]}


============================== 03:13:38.347003 | 16099031-128c-4820-95e0-d040148dd69a ==============================
[0m03:13:38.347003 [info ] [MainThread]: Running with dbt=1.8.0
[0m03:13:38.350609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:13:38.354706 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Profile default in profiles.yml is empty
  
[0m03:13:38.356089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.10435404, "process_user_time": 1.890583, "process_kernel_time": 0.256845, "process_mem_max_rss": "108072", "process_in_blocks": "58976", "process_out_blocks": "4059", "command_success": false}
[0m03:13:38.356701 [debug] [MainThread]: Command `dbt run` failed at 03:13:38.356579 after 0.11 seconds
[0m03:13:38.357154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5525b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6770a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5407620>]}
[0m03:13:38.357592 [debug] [MainThread]: Flushing usage events
[0m03:30:28.473878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6666c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf950b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd5e600>]}


============================== 03:30:28.491501 | 87fe3c0a-0353-4111-8208-f48351ab5a55 ==============================
[0m03:30:28.491501 [info ] [MainThread]: Running with dbt=1.8.0
[0m03:30:28.495273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:30:28.791688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87fe3c0a-0353-4111-8208-f48351ab5a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1579e0>]}
[0m03:30:28.834002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87fe3c0a-0353-4111-8208-f48351ab5a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafee3a10>]}
[0m03:30:28.835228 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:30:28.922241 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m03:30:28.923408 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:30:28.924338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '87fe3c0a-0353-4111-8208-f48351ab5a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5257f0>]}
[0m03:30:29.805073 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_driven_data.trusted_payment_data' (models/trusted_payment_data.sql) depends on a source named 'staging_source.dim_finance' which was not found
[0m03:30:29.810022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4279988, "process_user_time": 3.100301, "process_kernel_time": 0.483309, "process_mem_max_rss": "110092", "process_in_blocks": "93544", "process_out_blocks": "5", "command_success": false}
[0m03:30:29.810962 [debug] [MainThread]: Command `dbt run` failed at 03:30:29.810835 after 1.43 seconds
[0m03:30:29.811593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21885c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2ae810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2f7800>]}
[0m03:30:29.812090 [debug] [MainThread]: Flushing usage events
[0m03:47:34.141106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9457950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe09580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac269c0>]}


============================== 03:47:34.153069 | 615870e7-cf9f-44ca-8f02-65788571407d ==============================
[0m03:47:34.153069 [info ] [MainThread]: Running with dbt=1.8.0
[0m03:47:34.156968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:47:34.419744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '615870e7-cf9f-44ca-8f02-65788571407d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8137cb0>]}
[0m03:47:34.460005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '615870e7-cf9f-44ca-8f02-65788571407d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae71940>]}
[0m03:47:34.460955 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:47:34.535986 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m03:47:34.537163 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:47:34.538085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '615870e7-cf9f-44ca-8f02-65788571407d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81341d0>]}
[0m03:47:34.547302 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_driven_data: source.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: raw_source
    5  |   database: airflow
    6  |   schema: driven_raw
    7  |   tables:
    8  |     - name: raw_batch_data
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 5, column 3
[0m03:47:34.548737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.48948267, "process_user_time": 2.045316, "process_kernel_time": 0.435131, "process_mem_max_rss": "105172", "process_in_blocks": "79064", "process_out_blocks": "5", "command_success": false}
[0m03:47:34.549417 [debug] [MainThread]: Command `dbt run` failed at 03:47:34.549290 after 0.49 seconds
[0m03:47:34.550017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99976b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa989e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8de3890>]}
[0m03:47:34.550795 [debug] [MainThread]: Flushing usage events
[0m03:51:07.771129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a8c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4197a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa003da60>]}


============================== 03:51:07.779867 | c66c21c1-956f-4035-8308-cd24798b351e ==============================
[0m03:51:07.779867 [info ] [MainThread]: Running with dbt=1.8.0
[0m03:51:07.780561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:51:08.079497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee76b70>]}
[0m03:51:08.124005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06addc0>]}
[0m03:51:08.125175 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:51:08.217600 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m03:51:08.220405 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:51:08.221997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecf2f90>]}
[0m03:51:09.042483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee46000>]}
[0m03:51:09.129811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea98560>]}
[0m03:51:09.130577 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m03:51:09.131934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e923740>]}
[0m03:51:09.134192 [info ] [MainThread]: 
[0m03:51:09.135222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:51:09.139340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:51:09.192135 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:51:09.192616 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:51:09.193022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:09.202741 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m03:51:09.204344 [debug] [ThreadPool]: On list_airflow: Close
[0m03:51:09.205269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_driven_staging)
[0m03:51:09.205928 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "driven_staging"
"
[0m03:51:09.211285 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m03:51:09.211669 [debug] [ThreadPool]: On create_airflow_driven_staging: BEGIN
[0m03:51:09.213670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:09.221728 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m03:51:09.222188 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m03:51:09.222648 [debug] [ThreadPool]: On create_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_driven_staging"} */
create schema if not exists "driven_staging"
[0m03:51:09.234322 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m03:51:09.236020 [debug] [ThreadPool]: On create_airflow_driven_staging: COMMIT
[0m03:51:09.236717 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_staging"
[0m03:51:09.237211 [debug] [ThreadPool]: On create_airflow_driven_staging: COMMIT
[0m03:51:09.239957 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m03:51:09.240494 [debug] [ThreadPool]: On create_airflow_driven_staging: Close
[0m03:51:09.244228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_driven_staging, now list_airflow_driven_trusted)
[0m03:51:09.253001 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m03:51:09.253714 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m03:51:09.254307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:09.261141 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m03:51:09.261955 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m03:51:09.262477 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m03:51:09.277447 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m03:51:09.278976 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m03:51:09.279448 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m03:51:09.280156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m03:51:09.282861 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m03:51:09.283228 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m03:51:09.283526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:09.288859 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m03:51:09.292368 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m03:51:09.292756 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m03:51:09.296175 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m03:51:09.297324 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m03:51:09.297745 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m03:51:09.304390 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:09.304756 [debug] [MainThread]: On master: BEGIN
[0m03:51:09.305089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:51:09.309419 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:51:09.309795 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:09.310190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:51:09.314761 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m03:51:09.315899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee00980>]}
[0m03:51:09.316418 [debug] [MainThread]: On master: ROLLBACK
[0m03:51:09.316777 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:09.317039 [debug] [MainThread]: On master: BEGIN
[0m03:51:09.317512 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:51:09.317865 [debug] [MainThread]: On master: COMMIT
[0m03:51:09.318175 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:09.318505 [debug] [MainThread]: On master: COMMIT
[0m03:51:09.318896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:51:09.319196 [debug] [MainThread]: On master: Close
[0m03:51:09.319737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:51:09.320816 [info ] [MainThread]: 
[0m03:51:09.333129 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m03:51:09.333719 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m03:51:09.334349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.staging_dim_address)
[0m03:51:09.334724 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m03:51:09.404073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m03:51:09.406377 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m03:51:09.437300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m03:51:09.439083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m03:51:09.439478 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m03:51:09.439878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:09.443092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m03:51:09.443528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m03:51:09.443889 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
address,
mac_address,
ip_address
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:09.452718 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.009 seconds
[0m03:51:09.458172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m03:51:09.458532 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m03:51:09.459134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:09.473601 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m03:51:09.474006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m03:51:09.474360 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m03:51:09.475062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m03:51:09.479624 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m03:51:09.483608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m03:51:09.484017 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m03:51:09.484535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:09.486525 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m03:51:09.488019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa049ff80>]}
[0m03:51:09.488657 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 748[0m in 0.15s]
[0m03:51:09.489320 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m03:51:09.489722 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m03:51:09.490208 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m03:51:09.490925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m03:51:09.491236 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m03:51:09.493652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m03:51:09.494934 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m03:51:09.497518 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m03:51:09.498298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m03:51:09.498577 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m03:51:09.498862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:09.501559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m03:51:09.501951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m03:51:09.502268 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
accessed_at
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:09.506042 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.003 seconds
[0m03:51:09.508506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m03:51:09.508890 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m03:51:09.509439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:09.510755 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m03:51:09.511067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m03:51:09.511334 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m03:51:09.512199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:51:09.513995 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m03:51:09.514586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m03:51:09.514887 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m03:51:09.515255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:09.516243 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m03:51:09.516694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d910410>]}
[0m03:51:09.517283 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 748[0m in 0.03s]
[0m03:51:09.518134 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m03:51:09.518485 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m03:51:09.518886 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m03:51:09.519466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m03:51:09.519797 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m03:51:09.523637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m03:51:09.524574 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m03:51:09.527134 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m03:51:09.527937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m03:51:09.528248 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m03:51:09.528510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:09.530851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m03:51:09.531234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m03:51:09.531548 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
iban
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:09.533848 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.002 seconds
[0m03:51:09.536115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m03:51:09.536441 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m03:51:09.537098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:09.538538 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m03:51:09.538862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m03:51:09.539133 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m03:51:09.539772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m03:51:09.541463 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m03:51:09.542046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m03:51:09.542319 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m03:51:09.542687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:09.543683 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m03:51:09.544121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eed8200>]}
[0m03:51:09.544633 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 748[0m in 0.02s]
[0m03:51:09.545529 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m03:51:09.545886 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m03:51:09.546254 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m03:51:09.546859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m03:51:09.547161 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m03:51:09.549543 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m03:51:09.550342 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m03:51:09.552942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m03:51:09.553653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m03:51:09.553945 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m03:51:09.554200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:09.556617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m03:51:09.557070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m03:51:09.557413 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
person_name,
user_name,
email,
phone,
birth_date,
personal_number
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:09.563300 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.006 seconds
[0m03:51:09.565660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m03:51:09.565981 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m03:51:09.566440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:09.567896 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m03:51:09.568188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m03:51:09.568452 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m03:51:09.569328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:51:09.571073 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m03:51:09.571645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m03:51:09.571960 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m03:51:09.572553 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:09.576323 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m03:51:09.576863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d939a30>]}
[0m03:51:09.577479 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 748[0m in 0.03s]
[0m03:51:09.578573 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m03:51:09.579004 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m03:51:09.579529 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m03:51:09.580206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m03:51:09.580533 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m03:51:09.583078 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m03:51:09.583935 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m03:51:09.586652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m03:51:09.587414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m03:51:09.587710 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m03:51:09.587987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:09.591333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m03:51:09.591683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m03:51:09.592023 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
session_duration,
download_speed,
upload_speed,
consumed_traffic
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:09.594936 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.003 seconds
[0m03:51:09.597499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m03:51:09.597840 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m03:51:09.598352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:09.599654 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m03:51:09.599965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m03:51:09.600226 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m03:51:09.601104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:51:09.604278 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m03:51:09.604903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m03:51:09.605197 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m03:51:09.605614 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:09.606640 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m03:51:09.607157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66c21c1-956f-4035-8308-cd24798b351e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea6f350>]}
[0m03:51:09.607692 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 748[0m in 0.03s]
[0m03:51:09.608592 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m03:51:09.609940 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:09.610270 [debug] [MainThread]: On master: BEGIN
[0m03:51:09.610534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:51:09.614811 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m03:51:09.615254 [debug] [MainThread]: On master: COMMIT
[0m03:51:09.615516 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:09.615747 [debug] [MainThread]: On master: COMMIT
[0m03:51:09.616067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:51:09.616296 [debug] [MainThread]: On master: Close
[0m03:51:09.616639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:09.616969 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m03:51:09.617399 [info ] [MainThread]: 
[0m03:51:09.617807 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m03:51:09.619091 [debug] [MainThread]: Command end result
[0m03:51:09.647706 [info ] [MainThread]: 
[0m03:51:09.648433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:51:09.648897 [info ] [MainThread]: 
[0m03:51:09.649369 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m03:51:09.651367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9847931, "process_user_time": 4.493169, "process_kernel_time": 0.738242, "process_mem_max_rss": "118620", "process_in_blocks": "108560", "process_out_blocks": "2687"}
[0m03:51:09.651919 [debug] [MainThread]: Command `dbt run` succeeded at 03:51:09.651809 after 1.99 seconds
[0m03:51:09.652296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e91e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea81370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea81460>]}
[0m03:51:09.652600 [debug] [MainThread]: Flushing usage events
[0m03:51:13.939613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa253f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a03e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e3b140>]}


============================== 03:51:13.949190 | 92541691-5abb-471b-9825-9937e52054cf ==============================
[0m03:51:13.949190 [info ] [MainThread]: Running with dbt=1.8.0
[0m03:51:13.950187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:51:14.095433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0eac410>]}
[0m03:51:14.134120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19fbf80>]}
[0m03:51:14.135014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m03:51:14.201984 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m03:51:14.314483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:51:14.315096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:51:14.339863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0db8080>]}
[0m03:51:14.418844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0cf4470>]}
[0m03:51:14.419740 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m03:51:14.423914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0db88c0>]}
[0m03:51:14.427273 [info ] [MainThread]: 
[0m03:51:14.429295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:51:14.434503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m03:51:14.488491 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m03:51:14.489106 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m03:51:14.489459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:14.518414 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m03:51:14.520508 [debug] [ThreadPool]: On list_airflow: Close
[0m03:51:14.521708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_driven_trusted)
[0m03:51:14.522387 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "driven_trusted"
"
[0m03:51:14.528540 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m03:51:14.529098 [debug] [ThreadPool]: On create_airflow_driven_trusted: BEGIN
[0m03:51:14.529420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:14.534697 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m03:51:14.535209 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m03:51:14.535674 [debug] [ThreadPool]: On create_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_driven_trusted"} */
create schema if not exists "driven_trusted"
[0m03:51:14.537093 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m03:51:14.538071 [debug] [ThreadPool]: On create_airflow_driven_trusted: COMMIT
[0m03:51:14.538443 [debug] [ThreadPool]: Using postgres connection "create_airflow_driven_trusted"
[0m03:51:14.538758 [debug] [ThreadPool]: On create_airflow_driven_trusted: COMMIT
[0m03:51:14.540320 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m03:51:14.540648 [debug] [ThreadPool]: On create_airflow_driven_trusted: Close
[0m03:51:14.542935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_driven_trusted, now list_airflow_driven_trusted)
[0m03:51:14.548414 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m03:51:14.548786 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m03:51:14.549132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:14.552628 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m03:51:14.553191 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m03:51:14.553570 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m03:51:14.556894 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m03:51:14.557981 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m03:51:14.558411 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m03:51:14.558911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m03:51:14.560818 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m03:51:14.561134 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m03:51:14.561413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:14.564030 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m03:51:14.564548 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m03:51:14.565508 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m03:51:14.568149 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m03:51:14.569437 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m03:51:14.569840 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m03:51:14.574934 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:14.575367 [debug] [MainThread]: On master: BEGIN
[0m03:51:14.575679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:51:14.578913 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m03:51:14.579303 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:14.579643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:51:14.582620 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m03:51:14.583851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c1fdd0>]}
[0m03:51:14.584407 [debug] [MainThread]: On master: ROLLBACK
[0m03:51:14.584805 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:14.585117 [debug] [MainThread]: On master: BEGIN
[0m03:51:14.585590 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:51:14.585907 [debug] [MainThread]: On master: COMMIT
[0m03:51:14.586169 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:14.586448 [debug] [MainThread]: On master: COMMIT
[0m03:51:14.586842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:51:14.587128 [debug] [MainThread]: On master: Close
[0m03:51:14.587644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:51:14.588130 [info ] [MainThread]: 
[0m03:51:14.597736 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m03:51:14.598292 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m03:51:14.599030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.trusted_non_pii_data)
[0m03:51:14.599422 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m03:51:14.606806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m03:51:14.608122 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m03:51:14.640024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m03:51:14.641408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m03:51:14.641795 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m03:51:14.642187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:14.645180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m03:51:14.645579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m03:51:14.645975 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
'***MASKED***' AS person_name,
SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
SUBSTRING(dp.email, 1, 5) || '*****' AS email,
'***MASKED***' AS personal_number,
'***MASKED***' AS birth_date,
'***MASKED***' AS address,
'***MASKED***' AS phone,
SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:14.665330 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.019 seconds
[0m03:51:14.673687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m03:51:14.674792 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m03:51:14.676049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:51:14.694539 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m03:51:14.697032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m03:51:14.697697 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m03:51:14.699445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:51:14.705390 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m03:51:14.711547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m03:51:14.712196 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m03:51:14.714408 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:14.718443 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m03:51:14.721289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00fc3e0>]}
[0m03:51:14.722089 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 748[0m in 0.12s]
[0m03:51:14.723215 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m03:51:14.723764 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m03:51:14.724422 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m03:51:14.724979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m03:51:14.725713 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m03:51:14.729623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m03:51:14.730777 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m03:51:14.733436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m03:51:14.734452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m03:51:14.734802 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m03:51:14.735174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:14.738088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m03:51:14.738451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m03:51:14.738814 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
df.iban,
fnu.download_speed,
fnu.upload_speed,
fnu.session_duration,
fnu.consumed_traffic,
((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_finance" df
ON
fnu.unique_id = df.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:14.746545 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.007 seconds
[0m03:51:14.749135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m03:51:14.749504 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m03:51:14.750073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:14.751369 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m03:51:14.751726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m03:51:14.752069 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m03:51:14.752985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:51:14.754800 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m03:51:14.755795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m03:51:14.756271 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m03:51:14.756886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:14.758547 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m03:51:14.759143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf9af60>]}
[0m03:51:14.759740 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 748[0m in 0.03s]
[0m03:51:14.760752 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m03:51:14.761212 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m03:51:14.761713 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m03:51:14.762291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m03:51:14.762633 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m03:51:14.765964 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m03:51:14.767121 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m03:51:14.770161 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m03:51:14.772363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m03:51:14.772698 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m03:51:14.773028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:14.776869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m03:51:14.777247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m03:51:14.777629 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
dp.person_name,
dp.user_name,
dp.email,
dp.personal_number,
dp.birth_date,
da.address,
dp.phone,
da.mac_address,
da.ip_address,
df.iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:14.798659 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.021 seconds
[0m03:51:14.801354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m03:51:14.801720 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m03:51:14.802296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:14.803578 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m03:51:14.804001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m03:51:14.804312 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m03:51:14.805371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:51:14.808598 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m03:51:14.809258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m03:51:14.809587 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m03:51:14.810047 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:14.811059 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m03:51:14.811555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9beb4d70>]}
[0m03:51:14.812119 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 748[0m in 0.05s]
[0m03:51:14.812921 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m03:51:14.813314 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m03:51:14.813727 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m03:51:14.814352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m03:51:14.814694 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m03:51:14.817472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m03:51:14.818573 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m03:51:14.821146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m03:51:14.822192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m03:51:14.822503 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m03:51:14.822801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:14.825751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m03:51:14.826371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m03:51:14.826763 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
da.address,
da.mac_address,
da.ip_address,
fnu.download_speed,
fnu.upload_speed,
ROUND((fnu.session_duration/60), 1) as min_session_duration,
CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
ELSE false
END AS technical_issue
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_address" da
ON
fnu.unique_id = da.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m03:51:14.837089 [debug] [Thread-1 (]: SQL status: SELECT 748 in 0.010 seconds
[0m03:51:14.839797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m03:51:14.840160 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m03:51:14.840729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:51:14.842055 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m03:51:14.842389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m03:51:14.842704 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m03:51:14.843649 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:51:14.845485 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m03:51:14.846109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m03:51:14.846421 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m03:51:14.846860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:51:14.847858 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m03:51:14.848376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92541691-5abb-471b-9825-9937e52054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9beb70b0>]}
[0m03:51:14.848968 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 748[0m in 0.03s]
[0m03:51:14.849786 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m03:51:14.851071 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:14.851353 [debug] [MainThread]: On master: BEGIN
[0m03:51:14.851620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:51:14.854956 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m03:51:14.855325 [debug] [MainThread]: On master: COMMIT
[0m03:51:14.855563 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:14.855788 [debug] [MainThread]: On master: COMMIT
[0m03:51:14.856104 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:51:14.856336 [debug] [MainThread]: On master: Close
[0m03:51:14.856699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:14.857049 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m03:51:14.857560 [info ] [MainThread]: 
[0m03:51:14.858303 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m03:51:14.859191 [debug] [MainThread]: Command end result
[0m03:51:14.890918 [info ] [MainThread]: 
[0m03:51:14.891575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:51:14.891940 [info ] [MainThread]: 
[0m03:51:14.892346 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:51:14.893728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0260109, "process_user_time": 2.425729, "process_kernel_time": 0.335473, "process_mem_max_rss": "117720", "process_in_blocks": "38600", "process_out_blocks": "1844"}
[0m03:51:14.894365 [debug] [MainThread]: Command `dbt run` succeeded at 03:51:14.894254 after 1.03 seconds
[0m03:51:14.894803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa20ddb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2109dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be2aa80>]}
[0m03:51:14.895188 [debug] [MainThread]: Flushing usage events
[0m07:46:07.651502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921570b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94928e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92155280>]}


============================== 07:46:07.673309 | 7e240c85-ed5d-4833-b7fd-fe3d79c652e8 ==============================
[0m07:46:07.673309 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:46:07.675133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:46:08.111245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90eab260>]}
[0m07:46:08.165802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919e7d10>]}
[0m07:46:08.167745 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:46:08.320674 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:46:08.493609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:46:08.494372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:46:08.521226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d43c50>]}
[0m07:46:08.643672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ca91c0>]}
[0m07:46:08.636885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4ddbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaebab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefb4860>]}
[0m07:46:08.644594 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:46:08.644991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d68380>]}


============================== 07:46:08.645000 | 7f6bb917-44d7-4657-994f-d5c8d1c0a4de ==============================
[0m07:46:08.645000 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:46:08.645867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:46:08.648313 [info ] [MainThread]: 
[0m07:46:08.651050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:46:08.655669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:46:08.715258 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:46:08.717130 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:46:08.718401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:46:08.766353 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.048 seconds
[0m07:46:08.768018 [debug] [ThreadPool]: On list_airflow: Close
[0m07:46:08.771069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m07:46:08.776479 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m07:46:08.776763 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m07:46:08.777350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:46:08.780698 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:46:08.781211 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m07:46:08.781551 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m07:46:08.787226 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m07:46:08.788738 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m07:46:08.789505 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m07:46:08.790133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m07:46:08.792013 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m07:46:08.793003 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m07:46:08.793360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:46:08.797095 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:46:08.797547 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m07:46:08.797949 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m07:46:08.800031 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:46:08.801485 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m07:46:08.801842 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m07:46:08.806253 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:08.806590 [debug] [MainThread]: On master: BEGIN
[0m07:46:08.806855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:46:08.811195 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:46:08.811760 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:08.812174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:46:08.815246 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:46:08.816152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ca90a0>]}
[0m07:46:08.816611 [debug] [MainThread]: On master: ROLLBACK
[0m07:46:08.816995 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:08.817256 [debug] [MainThread]: On master: BEGIN
[0m07:46:08.817674 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:46:08.817970 [debug] [MainThread]: On master: COMMIT
[0m07:46:08.818414 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:08.818627 [debug] [MainThread]: On master: COMMIT
[0m07:46:08.818972 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:46:08.819208 [debug] [MainThread]: On master: Close
[0m07:46:08.819708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:46:08.820275 [info ] [MainThread]: 
[0m07:46:08.829572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae820260>]}
[0m07:46:08.836178 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m07:46:08.838482 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m07:46:08.841684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.staging_dim_address)
[0m07:46:08.844298 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m07:46:08.886815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m07:46:08.895302 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m07:46:08.966774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed8c680>]}
[0m07:46:08.971388 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:46:08.978018 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.006118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.007998 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m07:46:09.009228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.019968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m07:46:09.021156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.022164 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
address,
mac_address,
ip_address
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.074632 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.051 seconds
[0m07:46:09.093154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.094050 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:46:09.096526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:46:09.104632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.105408 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:46:09.106824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:46:09.118848 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:46:09.144229 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m07:46:09.145257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.146232 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m07:46:09.152571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:46:09.164499 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m07:46:09.170882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.171317 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m07:46:09.181682 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m07:46:09.192486 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m07:46:09.196440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934d5f70>]}
[0m07:46:09.198099 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 171[0m in 0.35s]
[0m07:46:09.200363 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m07:46:09.202925 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m07:46:09.205994 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m07:46:09.208557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m07:46:09.210065 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m07:46:09.217202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.221295 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m07:46:09.226434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.229173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.229787 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m07:46:09.231045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.245056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:46:09.246282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.246688 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
accessed_at
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.251959 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.004 seconds
[0m07:46:09.259815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.261026 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:46:09.262660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:46:09.265065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.265425 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:46:09.266091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.267328 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m07:46:09.267708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.268294 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m07:46:09.269762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:46:09.272751 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m07:46:09.273654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.274070 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m07:46:09.276272 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:46:09.277388 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m07:46:09.278092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe9ffe0>]}
[0m07:46:09.278702 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 171[0m in 0.07s]
[0m07:46:09.279429 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m07:46:09.279844 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.280518 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m07:46:09.281202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m07:46:09.281582 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.285382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.286832 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.293652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.295397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.296156 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m07:46:09.296009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:46:09.296824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.297089 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:46:09.306575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:46:09.307056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.307532 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
iban
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.311162 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.003 seconds
[0m07:46:09.314468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.315044 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:46:09.315873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.317718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.317999 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:46:09.318439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.319783 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m07:46:09.320078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.320354 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m07:46:09.321189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:46:09.322662 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m07:46:09.323217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.323537 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m07:46:09.325961 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:46:09.326995 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m07:46:09.327593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd66f60>]}
[0m07:46:09.328944 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 171[0m in 0.05s]
[0m07:46:09.332107 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.332560 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m07:46:09.333043 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m07:46:09.333461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m07:46:09.333796 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m07:46:09.333789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc3ad80>]}
[0m07:46:09.336088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.337204 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m07:46:09.339133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.340708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.341018 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m07:46:09.341399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.346872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:46:09.347376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.347795 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
person_name,
user_name,
email,
phone,
birth_date,
personal_number
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.353349 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.005 seconds
[0m07:46:09.355388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.355836 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:46:09.356458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.358269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.358554 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:46:09.359359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.360681 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m07:46:09.361059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.361336 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m07:46:09.362051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:46:09.363856 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m07:46:09.364739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.365157 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m07:46:09.367885 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:46:09.369853 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m07:46:09.375300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd66f60>]}
[0m07:46:09.376047 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 171[0m in 0.04s]
[0m07:46:09.377156 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m07:46:09.377728 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:09.378564 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m07:46:09.378953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m07:46:09.379441 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:09.381891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.382709 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:09.384745 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.385555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.385797 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m07:46:09.386111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.390313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:46:09.391312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.392303 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
session_duration,
download_speed,
upload_speed,
consumed_traffic
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.395702 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.002 seconds
[0m07:46:09.397948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.398415 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:46:09.399009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.402769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.403805 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:46:09.404694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.406692 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m07:46:09.407097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.407455 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m07:46:09.408476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:46:09.411172 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m07:46:09.413013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.413971 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m07:46:09.416248 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:46:09.417665 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m07:46:09.418242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e240c85-ed5d-4833-b7fd-fe3d79c652e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdb5640>]}
[0m07:46:09.421817 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 171[0m in 0.04s]
[0m07:46:09.424147 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:09.427997 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:09.428516 [debug] [MainThread]: On master: BEGIN
[0m07:46:09.428875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:46:09.431336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadae5bb0>]}
[0m07:46:09.432288 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:46:09.432764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadac2360>]}
[0m07:46:09.434405 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:46:09.435492 [debug] [MainThread]: On master: COMMIT
[0m07:46:09.435983 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:09.436773 [debug] [MainThread]: On master: COMMIT
[0m07:46:09.437683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:46:09.437759 [info ] [MainThread]: 
[0m07:46:09.439406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:46:09.439694 [debug] [MainThread]: On master: Close
[0m07:46:09.442236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:46:09.443553 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m07:46:09.446363 [info ] [MainThread]: 
[0m07:46:09.447004 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m07:46:09.447468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:46:09.448516 [debug] [MainThread]: Command end result
[0m07:46:09.492048 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:46:09.493448 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:46:09.495268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:46:09.505595 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m07:46:09.507403 [debug] [ThreadPool]: On list_airflow: Close
[0m07:46:09.508384 [info ] [MainThread]: 
[0m07:46:09.509203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:46:09.509623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m07:46:09.509881 [info ] [MainThread]: 
[0m07:46:09.510934 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:46:09.515505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0792184, "process_user_time": 3.431606, "process_kernel_time": 1.390057, "process_mem_max_rss": "110556", "process_in_blocks": "1352584", "process_out_blocks": "1837"}
[0m07:46:09.516192 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m07:46:09.516672 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m07:46:09.516943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:46:09.519012 [debug] [MainThread]: Command `dbt run` succeeded at 07:46:09.518482 after 2.08 seconds
[0m07:46:09.520161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cc9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cc9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cc98e0>]}
[0m07:46:09.520664 [debug] [MainThread]: Flushing usage events
[0m07:46:09.520887 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:46:09.521584 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m07:46:09.521978 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m07:46:09.529719 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m07:46:09.530962 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m07:46:09.531514 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m07:46:09.532157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m07:46:09.535062 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m07:46:09.535507 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m07:46:09.535865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:46:09.539986 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:46:09.540478 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m07:46:09.540743 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m07:46:09.543109 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:46:09.544129 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m07:46:09.544584 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m07:46:09.549080 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:09.549404 [debug] [MainThread]: On master: BEGIN
[0m07:46:09.549688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:46:09.558299 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:46:09.558893 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:09.559501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:46:09.567758 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m07:46:09.571066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface64a10>]}
[0m07:46:09.572827 [debug] [MainThread]: On master: ROLLBACK
[0m07:46:09.573497 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:09.574224 [debug] [MainThread]: On master: BEGIN
[0m07:46:09.575357 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:46:09.576417 [debug] [MainThread]: On master: COMMIT
[0m07:46:09.577153 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:09.577665 [debug] [MainThread]: On master: COMMIT
[0m07:46:09.578981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:46:09.580141 [debug] [MainThread]: On master: Close
[0m07:46:09.584743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:46:09.586165 [info ] [MainThread]: 
[0m07:46:09.601566 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m07:46:09.603064 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m07:46:09.607306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.staging_dim_address)
[0m07:46:09.608412 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m07:46:09.617557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.620577 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m07:46:09.656338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.665133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.666690 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m07:46:09.668032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.691799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m07:46:09.693126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.694055 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
address,
mac_address,
ip_address
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.709404 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.012 seconds
[0m07:46:09.717048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.718072 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:46:09.718940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.720858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.721179 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:46:09.721577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.749389 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m07:46:09.750186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.751132 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m07:46:09.756171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:46:09.764637 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m07:46:09.774659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m07:46:09.776052 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m07:46:09.781717 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:46:09.790944 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m07:46:09.792918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03c58e0>]}
[0m07:46:09.794440 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 171[0m in 0.18s]
[0m07:46:09.795264 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m07:46:09.796011 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m07:46:09.796694 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m07:46:09.797376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m07:46:09.797855 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m07:46:09.802296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.803720 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m07:46:09.806597 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.807940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.808432 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m07:46:09.808757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.815896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:46:09.816310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.816638 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
accessed_at
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.819667 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.001 seconds
[0m07:46:09.822812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.823313 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:46:09.824817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:46:09.829555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.833456 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:46:09.836485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:46:09.838509 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m07:46:09.839442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.840450 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m07:46:09.844209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:46:09.847423 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m07:46:09.848090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m07:46:09.848477 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m07:46:09.851770 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:46:09.854380 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m07:46:09.858298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadae62a0>]}
[0m07:46:09.859609 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 171[0m in 0.06s]
[0m07:46:09.860370 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m07:46:09.861576 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.862612 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m07:46:09.863442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m07:46:09.863849 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.866676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.868605 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.876693 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.878650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.879281 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m07:46:09.879660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.894308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:46:09.895280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.896657 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
iban
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.900268 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.002 seconds
[0m07:46:09.906417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.907394 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:46:09.908294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.911641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.912025 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:46:09.912587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.913863 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m07:46:09.914177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.914481 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m07:46:09.915102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:46:09.916451 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m07:46:09.917678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m07:46:09.918210 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m07:46:09.920434 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:46:09.922265 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m07:46:09.923781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc52630>]}
[0m07:46:09.924486 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 171[0m in 0.06s]
[0m07:46:09.926124 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m07:46:09.926538 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m07:46:09.927010 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m07:46:09.927464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m07:46:09.927795 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m07:46:09.930725 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.932025 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m07:46:09.935005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.936972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.937226 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m07:46:09.937517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.940736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m07:46:09.941132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.941410 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
person_name,
user_name,
email,
phone,
birth_date,
personal_number
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.946273 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.005 seconds
[0m07:46:09.950568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.950977 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:46:09.952114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:46:09.954395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.954661 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:46:09.955364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:09.956646 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m07:46:09.956945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.957328 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m07:46:09.958394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:46:09.960169 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m07:46:09.962189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m07:46:09.962732 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m07:46:09.964147 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:46:09.965491 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m07:46:09.966219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd4fa10>]}
[0m07:46:09.967922 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 171[0m in 0.04s]
[0m07:46:09.969860 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m07:46:09.970705 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:09.971547 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m07:46:09.972283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m07:46:09.972845 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:09.976000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.976790 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:09.979175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.983009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.984563 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m07:46:09.986125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:09.990827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:46:09.991257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:09.991659 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
session_duration,
download_speed,
upload_speed,
consumed_traffic
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m07:46:09.994284 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.002 seconds
[0m07:46:10.000274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:10.001373 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:46:10.003140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:46:10.012226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:10.013485 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:46:10.014366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:46:10.015958 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m07:46:10.016334 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:10.017296 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m07:46:10.019644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:46:10.023798 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m07:46:10.024479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m07:46:10.024813 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m07:46:10.027192 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m07:46:10.029323 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m07:46:10.030394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6bb917-44d7-4657-994f-d5c8d1c0a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc9b0e0>]}
[0m07:46:10.031847 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 171[0m in 0.06s]
[0m07:46:10.032756 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m07:46:10.036274 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:10.036585 [debug] [MainThread]: On master: BEGIN
[0m07:46:10.036831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:46:10.042357 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:46:10.042948 [debug] [MainThread]: On master: COMMIT
[0m07:46:10.043348 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:10.043599 [debug] [MainThread]: On master: COMMIT
[0m07:46:10.043971 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:46:10.044221 [debug] [MainThread]: On master: Close
[0m07:46:10.044643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:46:10.044879 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m07:46:10.045359 [info ] [MainThread]: 
[0m07:46:10.045817 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m07:46:10.046989 [debug] [MainThread]: Command end result
[0m07:46:10.083157 [info ] [MainThread]: 
[0m07:46:10.083759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:46:10.084194 [info ] [MainThread]: 
[0m07:46:10.084579 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:46:10.086562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5641943, "process_user_time": 3.434389, "process_kernel_time": 1.367147, "process_mem_max_rss": "110480", "process_in_blocks": "1348240", "process_out_blocks": "1837"}
[0m07:46:10.092099 [debug] [MainThread]: Command `dbt run` succeeded at 07:46:10.091891 after 1.57 seconds
[0m07:46:10.093164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefb4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb180d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00d86b0>]}
[0m07:46:10.093643 [debug] [MainThread]: Flushing usage events
[0m08:49:54.163442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10dfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04cd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10de1b0>]}


============================== 08:49:54.189227 | 83a3df09-7619-4188-a249-42124dde3208 ==============================
[0m08:49:54.189227 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:49:54.194369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:49:54.932131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdbc350>]}
[0m08:49:55.018272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb05e2ed0>]}
[0m08:49:55.020821 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:49:55.184167 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:49:55.376851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:49:55.379147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:49:55.404929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3042f0>]}
[0m08:49:55.484759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf136e10>]}
[0m08:49:55.485707 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:49:55.489313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2c1400>]}
[0m08:49:55.494484 [info ] [MainThread]: 
[0m08:49:55.495917 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:49:55.500182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:49:55.572078 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:49:55.572796 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:49:55.573127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:55.617605 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.044 seconds
[0m08:49:55.622727 [debug] [ThreadPool]: On list_airflow: Close
[0m08:49:55.626851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m08:49:55.636292 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:49:55.636682 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m08:49:55.636964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:55.644279 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:49:55.644685 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:49:55.644929 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m08:49:55.651406 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m08:49:55.654100 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m08:49:55.655036 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m08:49:55.656079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m08:49:55.661552 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:49:55.662339 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m08:49:55.663009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:55.670522 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:49:55.671628 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:49:55.672375 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m08:49:55.676360 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m08:49:55.678823 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m08:49:55.679337 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m08:49:55.686840 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:55.687130 [debug] [MainThread]: On master: BEGIN
[0m08:49:55.687379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:49:55.692458 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:49:55.692930 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:55.693215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:49:55.695954 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m08:49:55.698065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae370890>]}
[0m08:49:55.699378 [debug] [MainThread]: On master: ROLLBACK
[0m08:49:55.699759 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:55.700030 [debug] [MainThread]: On master: BEGIN
[0m08:49:55.700417 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:49:55.700897 [debug] [MainThread]: On master: COMMIT
[0m08:49:55.701118 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:55.701277 [debug] [MainThread]: On master: COMMIT
[0m08:49:55.701501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:49:55.701695 [debug] [MainThread]: On master: Close
[0m08:49:55.702268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:49:55.705163 [info ] [MainThread]: 
[0m08:49:55.720835 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m08:49:55.721516 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m08:49:55.722383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.trusted_non_pii_data)
[0m08:49:55.722897 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m08:49:55.728839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.729999 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m08:49:55.758552 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.760059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.760363 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m08:49:55.760698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:55.766147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:49:55.766535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.766872 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
'***MASKED***' AS person_name,
SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
SUBSTRING(dp.email, 1, 5) || '*****' AS email,
'***MASKED***' AS personal_number,
'***MASKED***' AS birth_date,
'***MASKED***' AS address,
'***MASKED***' AS phone,
SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:55.788609 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.021 seconds
[0m08:49:55.796003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.796378 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m08:49:55.798196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:49:55.800403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.800683 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m08:49:55.801080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:55.815815 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:49:55.816219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.816498 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:49:55.818981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:49:55.822941 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m08:49:55.825660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:49:55.825927 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m08:49:55.831166 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m08:49:55.833344 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m08:49:55.835222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf07d6a0>]}
[0m08:49:55.836478 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 171[0m in 0.11s]
[0m08:49:55.838933 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m08:49:55.839338 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m08:49:55.839849 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m08:49:55.840445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m08:49:55.840723 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m08:49:55.843551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.844413 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m08:49:55.846593 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.847397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.847687 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m08:49:55.848005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:55.851097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:49:55.851450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.851873 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
df.iban,
fnu.download_speed,
fnu.upload_speed,
fnu.session_duration,
fnu.consumed_traffic,
((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_finance" df
ON
fnu.unique_id = df.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:55.853870 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.002 seconds
[0m08:49:55.855921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.856186 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m08:49:55.856641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:55.858316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.858592 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m08:49:55.859152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:55.861434 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:49:55.861934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.862877 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:49:55.864294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:49:55.866745 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m08:49:55.867849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:49:55.868922 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m08:49:55.875101 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m08:49:55.877829 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m08:49:55.878635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae34bf50>]}
[0m08:49:55.879333 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 171[0m in 0.04s]
[0m08:49:55.881442 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m08:49:55.882299 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m08:49:55.883852 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m08:49:55.885207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m08:49:55.885885 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m08:49:55.890243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.891505 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m08:49:55.894705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.899093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.901874 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m08:49:55.902940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:55.911437 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:49:55.913690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.916310 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
dp.person_name,
dp.user_name,
dp.email,
dp.personal_number,
dp.birth_date,
da.address,
dp.phone,
da.mac_address,
da.ip_address,
df.iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:55.937357 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.020 seconds
[0m08:49:55.941491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.942652 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m08:49:55.945563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:55.948951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.949446 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m08:49:55.950298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:55.952515 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:49:55.953014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.953417 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:49:55.955462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:49:55.957278 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m08:49:55.957838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:49:55.958182 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m08:49:55.961928 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m08:49:55.963590 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m08:49:55.964786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2d4da0>]}
[0m08:49:55.969479 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 171[0m in 0.08s]
[0m08:49:55.970460 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m08:49:55.971486 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m08:49:55.972237 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m08:49:55.972963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m08:49:55.973622 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m08:49:55.976856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m08:49:55.979702 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m08:49:55.987189 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m08:49:55.990119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:49:55.990588 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m08:49:55.991555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:56.003506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m08:49:56.005918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:49:56.007060 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
da.address,
da.mac_address,
da.ip_address,
fnu.download_speed,
fnu.upload_speed,
ROUND((fnu.session_duration/60), 1) as min_session_duration,
CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
ELSE false
END AS technical_issue
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_address" da
ON
fnu.unique_id = da.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:56.018779 [debug] [Thread-1 (]: SQL status: SELECT 171 in 0.011 seconds
[0m08:49:56.021693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:49:56.022008 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m08:49:56.023202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:49:56.026674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:49:56.027328 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m08:49:56.028045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:56.029426 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:49:56.029745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:49:56.029992 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:49:56.032171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:49:56.033721 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m08:49:56.034267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:49:56.034504 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m08:49:56.037120 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:49:56.039764 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m08:49:56.041594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83a3df09-7619-4188-a249-42124dde3208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2cfcb0>]}
[0m08:49:56.043208 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 171[0m in 0.07s]
[0m08:49:56.045057 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m08:49:56.047335 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:56.047622 [debug] [MainThread]: On master: BEGIN
[0m08:49:56.047853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:49:56.051331 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:49:56.052336 [debug] [MainThread]: On master: COMMIT
[0m08:49:56.052934 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:56.053325 [debug] [MainThread]: On master: COMMIT
[0m08:49:56.053952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:49:56.054488 [debug] [MainThread]: On master: Close
[0m08:49:56.055108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:56.056534 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m08:49:56.057735 [info ] [MainThread]: 
[0m08:49:56.058316 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m08:49:56.059407 [debug] [MainThread]: Command end result
[0m08:49:56.098483 [info ] [MainThread]: 
[0m08:49:56.099452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:49:56.099971 [info ] [MainThread]: 
[0m08:49:56.100559 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:49:56.103981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5237818, "process_user_time": 4.642969, "process_kernel_time": 1.651156, "process_mem_max_rss": "110540", "process_in_blocks": "788256", "process_out_blocks": "1845"}
[0m08:49:56.105996 [debug] [MainThread]: Command `dbt run` succeeded at 08:49:56.105821 after 2.53 seconds
[0m08:49:56.106964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ebdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02f2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04250a0>]}
[0m08:49:56.107281 [debug] [MainThread]: Flushing usage events
[0m08:49:56.366441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c29dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c2a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c29f40>]}


============================== 08:49:56.374136 | 325ed7a8-28e3-4c3b-a151-ba595475fe8e ==============================
[0m08:49:56.374136 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:49:56.374815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:49:56.498702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974032c0>]}
[0m08:49:56.528541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9641f050>]}
[0m08:49:56.529217 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:49:56.586096 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:49:56.664961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:49:56.665493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:49:56.700739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9583b110>]}
[0m08:49:56.827985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bc2e40>]}
[0m08:49:56.829462 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:49:56.832242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94afddf0>]}
[0m08:49:56.836766 [info ] [MainThread]: 
[0m08:49:56.838212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:49:56.846638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:49:56.906208 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:49:56.907810 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:49:56.908752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:56.916356 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m08:49:56.917983 [debug] [ThreadPool]: On list_airflow: Close
[0m08:49:56.920352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m08:49:56.925627 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:49:56.926059 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m08:49:56.926616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:56.929966 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m08:49:56.930367 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:49:56.930829 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m08:49:56.933619 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m08:49:56.934786 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m08:49:56.935238 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m08:49:56.936002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m08:49:56.939685 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:49:56.939937 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m08:49:56.940258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:49:56.946566 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:49:56.947184 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:49:56.947396 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m08:49:56.950037 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m08:49:56.951033 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m08:49:56.951299 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m08:49:56.961720 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:56.962994 [debug] [MainThread]: On master: BEGIN
[0m08:49:56.963565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:49:56.971851 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:49:56.973098 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:56.974349 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:49:56.983570 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m08:49:56.986373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94db4440>]}
[0m08:49:56.987591 [debug] [MainThread]: On master: ROLLBACK
[0m08:49:56.989392 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:56.990335 [debug] [MainThread]: On master: BEGIN
[0m08:49:56.992174 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:49:56.993472 [debug] [MainThread]: On master: COMMIT
[0m08:49:56.994733 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:56.995640 [debug] [MainThread]: On master: COMMIT
[0m08:49:56.996670 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:49:56.997321 [debug] [MainThread]: On master: Close
[0m08:49:56.998756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:49:57.002236 [info ] [MainThread]: 
[0m08:49:57.022005 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m08:49:57.023025 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m08:49:57.024914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.staging_dim_address)
[0m08:49:57.025908 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m08:49:57.042039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.046434 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m08:49:57.118241 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.130002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.131618 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m08:49:57.134762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:57.207070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m08:49:57.210083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.338693 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
address,
mac_address,
ip_address
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:57.461065 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.120 seconds
[0m08:49:57.538553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.541323 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m08:49:57.545542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:49:57.557077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.558266 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m08:49:57.560648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:49:57.594722 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m08:49:57.600316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.601295 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m08:49:57.602486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:49:57.617663 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m08:49:57.630943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:49:57.633539 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m08:49:57.643379 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m08:49:57.651585 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m08:49:57.655709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97401ca0>]}
[0m08:49:57.659038 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 611[0m in 0.63s]
[0m08:49:57.662440 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m08:49:57.664446 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m08:49:57.665808 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m08:49:57.668467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m08:49:57.669476 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m08:49:57.675282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.679921 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m08:49:57.684684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.688920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.689966 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m08:49:57.692270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:57.705175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m08:49:57.707215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.708370 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
accessed_at
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:57.718019 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.008 seconds
[0m08:49:57.723529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.724326 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m08:49:57.725456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:57.728560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.729071 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:49:57.729966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:57.731626 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m08:49:57.732014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.732633 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m08:49:57.734886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:49:57.738040 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m08:49:57.738694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:49:57.739052 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m08:49:57.740409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:49:57.741833 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m08:49:57.745209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d5af00>]}
[0m08:49:57.746855 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 611[0m in 0.08s]
[0m08:49:57.748808 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m08:49:57.750755 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m08:49:57.751409 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m08:49:57.752073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m08:49:57.752396 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m08:49:57.754948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.756749 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m08:49:57.761159 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.763886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.764705 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m08:49:57.765050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:57.768754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:49:57.772237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.773302 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
iban
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:57.776202 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.002 seconds
[0m08:49:57.778812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.779438 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m08:49:57.780400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:57.782852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.787208 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m08:49:57.788867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:57.793776 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m08:49:57.801929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.802437 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m08:49:57.813135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:49:57.816111 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m08:49:57.824291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:49:57.839259 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m08:49:57.841295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:49:57.846997 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m08:49:57.849240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ccc290>]}
[0m08:49:57.851950 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 611[0m in 0.10s]
[0m08:49:57.853928 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m08:49:57.854628 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m08:49:57.858068 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m08:49:57.858936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m08:49:57.859229 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m08:49:57.863544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.864642 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m08:49:57.867686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.868572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.868851 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m08:49:57.869141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:57.876493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:49:57.877700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.878593 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
person_name,
user_name,
email,
phone,
birth_date,
personal_number
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:57.889955 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.011 seconds
[0m08:49:57.894269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.895045 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m08:49:57.895775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:57.898309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.899137 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m08:49:57.899792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:49:57.903034 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m08:49:57.903892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.904888 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m08:49:57.909298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:49:57.912669 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m08:49:57.913716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:49:57.914090 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m08:49:57.918939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m08:49:57.920502 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m08:49:57.921118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c6a450>]}
[0m08:49:57.922274 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 611[0m in 0.06s]
[0m08:49:57.923965 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m08:49:57.924488 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m08:49:57.924948 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m08:49:57.925631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m08:49:57.926093 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m08:49:57.928919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.929742 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m08:49:57.932926 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.941187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.942979 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m08:49:57.943639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:49:57.949535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:49:57.950631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.951710 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
session_duration,
download_speed,
upload_speed,
consumed_traffic
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:49:57.954705 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.003 seconds
[0m08:49:57.962974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.963815 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m08:49:57.964892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:49:57.968401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.969051 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m08:49:57.974980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:49:57.977424 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m08:49:57.977841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.980508 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m08:49:57.985263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:49:57.988556 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m08:49:57.989385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:49:57.990050 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m08:49:57.992894 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:49:57.995027 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m08:49:57.996017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ed7a8-28e3-4c3b-a151-ba595475fe8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cad400>]}
[0m08:49:57.998010 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 611[0m in 0.07s]
[0m08:49:57.999747 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m08:49:58.006277 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:58.008116 [debug] [MainThread]: On master: BEGIN
[0m08:49:58.009904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:49:58.024930 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m08:49:58.025601 [debug] [MainThread]: On master: COMMIT
[0m08:49:58.026218 [debug] [MainThread]: Using postgres connection "master"
[0m08:49:58.026503 [debug] [MainThread]: On master: COMMIT
[0m08:49:58.026955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:49:58.027346 [debug] [MainThread]: On master: Close
[0m08:49:58.028320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:58.029243 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m08:49:58.031956 [info ] [MainThread]: 
[0m08:49:58.033609 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m08:49:58.039232 [debug] [MainThread]: Command end result
[0m08:49:58.222777 [info ] [MainThread]: 
[0m08:49:58.226458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:49:58.234274 [info ] [MainThread]: 
[0m08:49:58.240818 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:49:58.264376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.006794, "process_user_time": 4.268625, "process_kernel_time": 0.894794, "process_mem_max_rss": "117400", "process_in_blocks": "79912", "process_out_blocks": "1837"}
[0m08:49:58.272159 [debug] [MainThread]: Command `dbt run` succeeded at 08:49:58.269681 after 2.01 seconds
[0m08:49:58.285641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c29dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959ef500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ae4b00>]}
[0m08:49:58.289296 [debug] [MainThread]: Flushing usage events
[0m08:50:04.423506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984b4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984b7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984b7a70>]}


============================== 08:50:04.429698 | 111d9571-f9e8-480f-b609-2fd679170602 ==============================
[0m08:50:04.429698 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:50:04.430445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:50:04.697545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984d71a0>]}
[0m08:50:04.733754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d16e40>]}
[0m08:50:04.736523 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:50:04.841126 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:50:04.966823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:04.967396 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:04.988623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979385c0>]}
[0m08:50:05.060977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97878e00>]}
[0m08:50:05.061993 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:50:05.063005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979380b0>]}
[0m08:50:05.065738 [info ] [MainThread]: 
[0m08:50:05.066627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:50:05.069611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:50:05.106879 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:50:05.107895 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:50:05.108232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:05.115065 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m08:50:05.116219 [debug] [ThreadPool]: On list_airflow: Close
[0m08:50:05.118638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m08:50:05.121994 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:05.122255 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m08:50:05.124261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:05.129592 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:50:05.129957 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:05.130770 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m08:50:05.133759 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m08:50:05.135022 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m08:50:05.135414 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m08:50:05.135982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m08:50:05.139591 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:05.139894 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m08:50:05.140123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:05.145028 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:50:05.145736 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:05.146188 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m08:50:05.148973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m08:50:05.150367 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m08:50:05.151228 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m08:50:05.162062 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:05.162565 [debug] [MainThread]: On master: BEGIN
[0m08:50:05.162986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:05.166851 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:50:05.167201 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:05.167615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:50:05.170552 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:50:05.171356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98588350>]}
[0m08:50:05.172170 [debug] [MainThread]: On master: ROLLBACK
[0m08:50:05.172489 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:05.172718 [debug] [MainThread]: On master: BEGIN
[0m08:50:05.173201 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:50:05.173496 [debug] [MainThread]: On master: COMMIT
[0m08:50:05.173690 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:05.173901 [debug] [MainThread]: On master: COMMIT
[0m08:50:05.174428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:05.175029 [debug] [MainThread]: On master: Close
[0m08:50:05.175487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:05.176127 [info ] [MainThread]: 
[0m08:50:05.184493 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:05.185145 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m08:50:05.185685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.trusted_non_pii_data)
[0m08:50:05.185973 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:05.191378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.192556 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:05.226022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.230347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.230962 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m08:50:05.231711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:05.240312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:50:05.241740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.242270 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
'***MASKED***' AS person_name,
SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
SUBSTRING(dp.email, 1, 5) || '*****' AS email,
'***MASKED***' AS personal_number,
'***MASKED***' AS birth_date,
'***MASKED***' AS address,
'***MASKED***' AS phone,
SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:05.265268 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.022 seconds
[0m08:50:05.271052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.272302 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m08:50:05.274014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:50:05.276688 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.277004 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m08:50:05.277555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:05.288882 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:50:05.289274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.289563 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:50:05.290438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:05.295553 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m08:50:05.301127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:05.301523 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m08:50:05.304701 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m08:50:05.306613 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m08:50:05.307939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0a1c10>]}
[0m08:50:05.308786 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 611[0m in 0.12s]
[0m08:50:05.310602 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:05.311258 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m08:50:05.311680 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m08:50:05.312210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m08:50:05.312535 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m08:50:05.314880 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.316050 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m08:50:05.318037 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.319381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.320068 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m08:50:05.321330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:05.326643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:50:05.327562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.328089 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
df.iban,
fnu.download_speed,
fnu.upload_speed,
fnu.session_duration,
fnu.consumed_traffic,
((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_finance" df
ON
fnu.unique_id = df.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:05.335601 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.007 seconds
[0m08:50:05.339427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.339956 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m08:50:05.340631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:05.342881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.343653 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m08:50:05.345157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:50:05.346557 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:50:05.346897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.347183 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:50:05.348736 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:05.350411 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m08:50:05.351027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:05.351337 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m08:50:05.352933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:05.354209 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m08:50:05.354671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96936ed0>]}
[0m08:50:05.355732 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 611[0m in 0.04s]
[0m08:50:05.357432 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m08:50:05.358332 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m08:50:05.359535 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m08:50:05.360380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m08:50:05.361185 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m08:50:05.365739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.366753 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m08:50:05.368771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.369625 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.369902 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m08:50:05.370140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:05.374163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:50:05.374502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.374781 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
dp.person_name,
dp.user_name,
dp.email,
dp.personal_number,
dp.birth_date,
da.address,
dp.phone,
da.mac_address,
da.ip_address,
df.iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:05.386405 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.011 seconds
[0m08:50:05.388606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.389044 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m08:50:05.390888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:05.392515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.392810 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m08:50:05.393284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:05.394600 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:50:05.394906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.395187 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:50:05.396955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:05.399053 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m08:50:05.399640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:05.400283 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m08:50:05.401758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:05.402723 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m08:50:05.403178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969b8800>]}
[0m08:50:05.405763 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 611[0m in 0.04s]
[0m08:50:05.406492 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m08:50:05.406851 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m08:50:05.407260 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m08:50:05.407796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m08:50:05.408119 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m08:50:05.410459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.411570 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m08:50:05.417943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.419836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.420193 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m08:50:05.420570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:05.423776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:50:05.424197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.424708 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
da.address,
da.mac_address,
da.ip_address,
fnu.download_speed,
fnu.upload_speed,
ROUND((fnu.session_duration/60), 1) as min_session_duration,
CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
ELSE false
END AS technical_issue
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_address" da
ON
fnu.unique_id = da.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:05.431087 [debug] [Thread-1 (]: SQL status: SELECT 611 in 0.006 seconds
[0m08:50:05.433180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.433460 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m08:50:05.433985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:05.435590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.435829 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m08:50:05.436153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:05.437127 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:50:05.437402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.437631 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:50:05.438989 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:05.440389 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m08:50:05.441015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:05.441292 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m08:50:05.442713 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:05.444726 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m08:50:05.445291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '111d9571-f9e8-480f-b609-2fd679170602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a791f0>]}
[0m08:50:05.446195 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 611[0m in 0.04s]
[0m08:50:05.448788 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m08:50:05.451346 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:05.451749 [debug] [MainThread]: On master: BEGIN
[0m08:50:05.452244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:05.460204 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:50:05.461293 [debug] [MainThread]: On master: COMMIT
[0m08:50:05.461596 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:05.461826 [debug] [MainThread]: On master: COMMIT
[0m08:50:05.462157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:05.462384 [debug] [MainThread]: On master: Close
[0m08:50:05.462756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:05.462978 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m08:50:05.463793 [info ] [MainThread]: 
[0m08:50:05.464331 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m08:50:05.465391 [debug] [MainThread]: Command end result
[0m08:50:05.510910 [info ] [MainThread]: 
[0m08:50:05.511401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:50:05.511868 [info ] [MainThread]: 
[0m08:50:05.512385 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:50:05.519687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2401956, "process_user_time": 2.7342, "process_kernel_time": 0.477811, "process_mem_max_rss": "118048", "process_in_blocks": "31120", "process_out_blocks": "1845"}
[0m08:50:05.521123 [debug] [MainThread]: Command `dbt run` succeeded at 08:50:05.520996 after 1.24 seconds
[0m08:50:05.523240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977a48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984b49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0a1c10>]}
[0m08:50:05.523626 [debug] [MainThread]: Flushing usage events
[0m08:50:05.609059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14256d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa153a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18a2660>]}


============================== 08:50:05.617186 | 22bcfc33-a418-4d6a-a7f4-bb465a2127f5 ==============================
[0m08:50:05.617186 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:50:05.609068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2fea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1a4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2dffb0>]}
[0m08:50:05.618044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}


============================== 08:50:05.621074 | 9a1b604e-17bb-4f96-ab0b-53e32be3d8cb ==============================
[0m08:50:05.621074 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:50:05.622301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:50:05.856018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05ac230>]}
[0m08:50:05.856026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc54140>]}
[0m08:50:05.881088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02d7470>]}
[0m08:50:05.881394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1055b80>]}
[0m08:50:05.881717 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:50:05.882313 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:50:05.972775 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:50:05.975363 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:50:06.108310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:06.109044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:06.109033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:06.112683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:06.127921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb47a10>]}
[0m08:50:06.133416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05c45c0>]}
[0m08:50:06.246901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada6d670>]}
[0m08:50:06.248200 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:50:06.248993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadaf0350>]}
[0m08:50:06.252372 [info ] [MainThread]: 
[0m08:50:06.253200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:50:06.253983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0141dc0>]}
[0m08:50:06.255008 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:50:06.255901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa109dbb0>]}
[0m08:50:06.258555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:50:06.258985 [info ] [MainThread]: 
[0m08:50:06.263248 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:50:06.268292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:50:06.300504 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:50:06.301863 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:50:06.302802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:06.304560 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:50:06.305355 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:50:06.306295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:06.313533 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m08:50:06.313695 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m08:50:06.314896 [debug] [ThreadPool]: On list_airflow: Close
[0m08:50:06.315142 [debug] [ThreadPool]: On list_airflow: Close
[0m08:50:06.317780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m08:50:06.317959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m08:50:06.325172 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:06.325796 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m08:50:06.326362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:06.329763 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:06.330213 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m08:50:06.330509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:06.330924 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:50:06.331278 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:06.331948 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m08:50:06.334296 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:50:06.335266 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:06.335818 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m08:50:06.336676 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m08:50:06.338450 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m08:50:06.338801 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m08:50:06.339293 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m08:50:06.340245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m08:50:06.340616 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m08:50:06.341694 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m08:50:06.344118 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:06.344691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m08:50:06.345344 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m08:50:06.345707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:06.347603 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:06.348019 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m08:50:06.348751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:06.355310 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:50:06.355474 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:50:06.355981 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:06.356156 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:06.356586 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m08:50:06.356996 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m08:50:06.361114 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m08:50:06.361432 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m08:50:06.363662 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m08:50:06.364552 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m08:50:06.364600 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m08:50:06.365735 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m08:50:06.371821 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.373299 [debug] [MainThread]: On master: BEGIN
[0m08:50:06.373852 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.374024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:06.374512 [debug] [MainThread]: On master: BEGIN
[0m08:50:06.375949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:06.380635 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:50:06.381851 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.382199 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:50:06.383517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:50:06.383744 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.384864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:50:06.390915 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:50:06.390710 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m08:50:06.393327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7178f0>]}
[0m08:50:06.393733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01cbf20>]}
[0m08:50:06.394297 [debug] [MainThread]: On master: ROLLBACK
[0m08:50:06.394848 [debug] [MainThread]: On master: ROLLBACK
[0m08:50:06.395425 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.396041 [debug] [MainThread]: On master: BEGIN
[0m08:50:06.395991 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.397033 [debug] [MainThread]: On master: BEGIN
[0m08:50:06.397617 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:50:06.398473 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.398566 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:50:06.399107 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.400132 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.400161 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.400895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.401250 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.401528 [debug] [MainThread]: On master: Close
[0m08:50:06.401929 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.402731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:06.403800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.403551 [info ] [MainThread]: 
[0m08:50:06.405339 [debug] [MainThread]: On master: Close
[0m08:50:06.408745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:06.412333 [info ] [MainThread]: 
[0m08:50:06.420701 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m08:50:06.421638 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m08:50:06.422332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.staging_dim_address)
[0m08:50:06.422787 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m08:50:06.423939 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_address
[0m08:50:06.424659 [info ] [Thread-1 (]: 1 of 5 START sql table model driven_staging.dim_address ........................ [RUN]
[0m08:50:06.425322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.staging_dim_address)
[0m08:50:06.426018 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_address
[0m08:50:06.432994 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.434599 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m08:50:06.439508 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.441153 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_address
[0m08:50:06.468155 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.469809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.470185 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m08:50:06.470489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.471194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.472264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.472634 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: BEGIN
[0m08:50:06.472984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m08:50:06.473015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.473407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.473813 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
address,
mac_address,
ip_address
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.476685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:50:06.477662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.478360 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */

  
    

  create  table "airflow"."driven_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
address,
mac_address,
ip_address
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.481279 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.007 seconds
[0m08:50:06.486264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.486585 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m08:50:06.487050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.488860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.489117 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m08:50:06.489490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.505531 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m08:50:06.506037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.506413 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m08:50:06.507331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:06.512027 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.033 seconds
[0m08:50:06.513082 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m08:50:06.518335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.518661 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m08:50:06.519027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.519427 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m08:50:06.520104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.521765 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:50:06.523444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.524046 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
alter table "airflow"."driven_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m08:50:06.524980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.525993 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m08:50:06.528341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02d5d00>]}
[0m08:50:06.529024 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 692[0m in 0.10s]
[0m08:50:06.529604 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m08:50:06.530186 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m08:50:06.530610 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m08:50:06.531004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m08:50:06.531236 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m08:50:06.533279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.534070 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m08:50:06.536093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.536815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.537037 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m08:50:06.537253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.538917 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m08:50:06.539279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.539607 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: COMMIT
[0m08:50:06.539968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:50:06.540321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.540341 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.540588 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
accessed_at
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.542310 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.001 seconds
[0m08:50:06.543992 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_address__dbt_backup"
[0m08:50:06.544155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.544413 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m08:50:06.544990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.546948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.547297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_address"
[0m08:50:06.547414 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:50:06.547702 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_address"} */
drop table if exists "airflow"."driven_staging"."dim_address__dbt_backup" cascade
[0m08:50:06.547944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.549371 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m08:50:06.549736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.549809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:50:06.549978 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m08:50:06.550431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.551813 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_address: Close
[0m08:50:06.551950 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m08:50:06.552495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.552838 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m08:50:06.552966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c3dd00>]}
[0m08:50:06.553444 [info ] [Thread-1 (]: 1 of 5 OK created sql table model driven_staging.dim_address ................... [[32mSELECT 692[0m in 0.13s]
[0m08:50:06.553987 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_address
[0m08:50:06.554105 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.554317 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_date
[0m08:50:06.554670 [info ] [Thread-1 (]: 2 of 5 START sql table model driven_staging.dim_date ........................... [RUN]
[0m08:50:06.554905 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m08:50:06.554985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_address, now model.dbt_driven_data.staging_dim_date)
[0m08:50:06.555302 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_date
[0m08:50:06.555326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc6d400>]}
[0m08:50:06.555799 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 692[0m in 0.02s]
[0m08:50:06.556361 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m08:50:06.556669 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.556960 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m08:50:06.557247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m08:50:06.557338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.557471 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.558112 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_date
[0m08:50:06.559397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.559966 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.560040 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.560594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.560864 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: BEGIN
[0m08:50:06.561080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.563022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m08:50:06.563105 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.563325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.563625 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */

  
    

  create  table "airflow"."driven_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
accessed_at
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.563843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.564076 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m08:50:06.564284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.566093 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.002 seconds
[0m08:50:06.566905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m08:50:06.567753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.568197 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
iban
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.569427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.569735 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m08:50:06.570272 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.002 seconds
[0m08:50:06.570318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.572525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.572645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.572880 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
alter table "airflow"."driven_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:50:06.573002 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m08:50:06.573356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.573415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.574368 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m08:50:06.574612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.574825 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: COMMIT
[0m08:50:06.575041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.575312 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m08:50:06.575521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.575699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.576792 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m08:50:06.576815 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_date__dbt_backup"
[0m08:50:06.577051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.577266 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m08:50:06.577295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_date"
[0m08:50:06.577534 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_date"} */
drop table if exists "airflow"."driven_staging"."dim_date__dbt_backup" cascade
[0m08:50:06.577788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.578324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.578978 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m08:50:06.579075 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_date: Close
[0m08:50:06.579479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.579465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f65baa0>]}
[0m08:50:06.579740 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m08:50:06.580058 [info ] [Thread-1 (]: 2 of 5 OK created sql table model driven_staging.dim_date ...................... [[32mSELECT 692[0m in 0.02s]
[0m08:50:06.580808 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_date
[0m08:50:06.581111 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.581424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.581490 [info ] [Thread-1 (]: 3 of 5 START sql table model driven_staging.dim_finance ........................ [RUN]
[0m08:50:06.581809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_date, now model.dbt_driven_data.staging_dim_finance)
[0m08:50:06.582044 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.582210 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m08:50:06.582634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbbc410>]}
[0m08:50:06.583116 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 692[0m in 0.03s]
[0m08:50:06.583808 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.584112 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m08:50:06.584564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.584781 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m08:50:06.585230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m08:50:06.585433 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.585467 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m08:50:06.587421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.588260 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m08:50:06.588571 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.589288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.589530 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: BEGIN
[0m08:50:06.589897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.590263 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.591334 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.591612 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m08:50:06.591858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.592210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m08:50:06.592768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.593026 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */

  
    

  create  table "airflow"."driven_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
iban
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.593921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m08:50:06.594176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.595014 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.002 seconds
[0m08:50:06.595013 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
person_name,
user_name,
email,
phone,
birth_date,
personal_number
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.596869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.597130 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m08:50:06.597642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.597922 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.003 seconds
[0m08:50:06.599359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.599604 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
alter table "airflow"."driven_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m08:50:06.599874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.599964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.600118 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m08:50:06.600483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.600958 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m08:50:06.601193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.601406 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: COMMIT
[0m08:50:06.602093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.602336 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m08:50:06.602404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:06.602758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.603606 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_finance__dbt_backup"
[0m08:50:06.603750 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m08:50:06.603985 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.604083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_finance"
[0m08:50:06.604203 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m08:50:06.604311 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_finance"} */
drop table if exists "airflow"."driven_staging"."dim_finance__dbt_backup" cascade
[0m08:50:06.604891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.605124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.605870 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_finance: Close
[0m08:50:06.606140 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m08:50:06.606255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5c82c0>]}
[0m08:50:06.607683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.607686 [info ] [Thread-1 (]: 3 of 5 OK created sql table model driven_staging.dim_finance ................... [[32mSELECT 692[0m in 0.02s]
[0m08:50:06.607908 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m08:50:06.608050 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_finance
[0m08:50:06.608330 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_dim_person
[0m08:50:06.608711 [info ] [Thread-1 (]: 4 of 5 START sql table model driven_staging.dim_person ......................... [RUN]
[0m08:50:06.609293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_finance, now model.dbt_driven_data.staging_dim_person)
[0m08:50:06.609508 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.610016 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_dim_person
[0m08:50:06.611079 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m08:50:06.611654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb8f800>]}
[0m08:50:06.612855 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 692[0m in 0.03s]
[0m08:50:06.614686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.614747 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m08:50:06.615665 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.616034 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_dim_person
[0m08:50:06.616186 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m08:50:06.616673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m08:50:06.616990 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.619128 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.619559 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.619958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.620188 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: BEGIN
[0m08:50:06.620432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.620410 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.622699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.623144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:50:06.623490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.623873 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */

  
    

  create  table "airflow"."driven_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
person_name,
user_name,
email,
phone,
birth_date,
personal_number
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.623899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.624186 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m08:50:06.625371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.628665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:50:06.629449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.630461 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
session_duration,
download_speed,
upload_speed,
consumed_traffic
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.630871 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.006 seconds
[0m08:50:06.634954 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.004 seconds
[0m08:50:06.635736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.636202 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m08:50:06.636923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.637842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.638125 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m08:50:06.638541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.638790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.639038 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
alter table "airflow"."driven_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m08:50:06.639481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.640598 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m08:50:06.640887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.641169 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: COMMIT
[0m08:50:06.641356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.641707 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m08:50:06.642371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.642599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:06.644245 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m08:50:06.644649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.644684 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."dim_person__dbt_backup"
[0m08:50:06.645042 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m08:50:06.645414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_dim_person"
[0m08:50:06.645891 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_dim_person"} */
drop table if exists "airflow"."driven_staging"."dim_person__dbt_backup" cascade
[0m08:50:06.646018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:06.647651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.647851 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m08:50:06.648439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.648747 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_dim_person: Close
[0m08:50:06.648800 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m08:50:06.649282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f55dc70>]}
[0m08:50:06.649800 [info ] [Thread-1 (]: 4 of 5 OK created sql table model driven_staging.dim_person .................... [[32mSELECT 692[0m in 0.04s]
[0m08:50:06.649941 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.650443 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_dim_person
[0m08:50:06.650776 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.651067 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m08:50:06.651181 [info ] [Thread-1 (]: 5 of 5 START sql table model driven_staging.fact_network_usage ................. [RUN]
[0m08:50:06.651472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1b604e-17bb-4f96-ab0b-53e32be3d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbaab70>]}
[0m08:50:06.651775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.staging_dim_person, now model.dbt_driven_data.staging_fact_network_usage)
[0m08:50:06.652228 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.652079 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 692[0m in 0.03s]
[0m08:50:06.653522 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.655906 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.656211 [debug] [MainThread]: On master: BEGIN
[0m08:50:06.656246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.656439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:06.657393 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.660494 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.660762 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:50:06.661208 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.661619 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.662004 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.662219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.662562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.662675 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: BEGIN
[0m08:50:06.663112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:06.662999 [debug] [MainThread]: On master: Close
[0m08:50:06.664218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:06.665260 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m08:50:06.666066 [info ] [MainThread]: 
[0m08:50:06.666509 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m08:50:06.666791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:50:06.667150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.667507 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."driven_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
unique_id,
session_duration,
download_speed,
upload_speed,
consumed_traffic
FROM
"airflow"."driven_raw"."raw_batch_data"
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:06.668055 [debug] [MainThread]: Command end result
[0m08:50:06.670514 [debug] [Thread-1 (]: SQL status: SELECT 692 in 0.002 seconds
[0m08:50:06.675079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.675805 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m08:50:06.676952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.680942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.681307 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
alter table "airflow"."driven_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m08:50:06.681863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:06.683377 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m08:50:06.683957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.684541 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: COMMIT
[0m08:50:06.686178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:06.689728 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_staging"."fact_network_usage__dbt_backup"
[0m08:50:06.690254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.staging_fact_network_usage"
[0m08:50:06.690511 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.staging_fact_network_usage"} */
drop table if exists "airflow"."driven_staging"."fact_network_usage__dbt_backup" cascade
[0m08:50:06.691672 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:06.692741 [debug] [Thread-1 (]: On model.dbt_driven_data.staging_fact_network_usage: Close
[0m08:50:06.693206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22bcfc33-a418-4d6a-a7f4-bb465a2127f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5a8980>]}
[0m08:50:06.693679 [info ] [Thread-1 (]: 5 of 5 OK created sql table model driven_staging.fact_network_usage ............ [[32mSELECT 692[0m in 0.04s]
[0m08:50:06.694199 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.staging_fact_network_usage
[0m08:50:06.695492 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.695759 [debug] [MainThread]: On master: BEGIN
[0m08:50:06.695971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:06.698140 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m08:50:06.698370 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.698643 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:06.698894 [debug] [MainThread]: On master: COMMIT
[0m08:50:06.699242 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:06.699547 [debug] [MainThread]: On master: Close
[0m08:50:06.699935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:06.700224 [debug] [MainThread]: Connection 'model.dbt_driven_data.staging_fact_network_usage' was properly closed.
[0m08:50:06.700624 [info ] [MainThread]: 
[0m08:50:06.701107 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m08:50:06.702259 [debug] [MainThread]: Command end result
[0m08:50:06.706080 [info ] [MainThread]: 
[0m08:50:06.707056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:50:06.707759 [info ] [MainThread]: 
[0m08:50:06.708608 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:50:06.712103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1855524, "process_user_time": 2.278352, "process_kernel_time": 0.323898, "process_mem_max_rss": "118284", "process_in_blocks": "7840", "process_out_blocks": "1837"}
[0m08:50:06.712927 [debug] [MainThread]: Command `dbt run` succeeded at 08:50:06.712848 after 1.19 seconds
[0m08:50:06.713406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec717c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9f06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9d4b90>]}
[0m08:50:06.713731 [debug] [MainThread]: Flushing usage events
[0m08:50:06.736168 [info ] [MainThread]: 
[0m08:50:06.736971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:50:06.737242 [info ] [MainThread]: 
[0m08:50:06.737695 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:50:06.739062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.212506, "process_user_time": 2.247102, "process_kernel_time": 0.333239, "process_mem_max_rss": "117952", "process_in_blocks": "3272", "process_out_blocks": "1837"}
[0m08:50:06.740037 [debug] [MainThread]: Command `dbt run` succeeded at 08:50:06.739909 after 1.21 seconds
[0m08:50:06.740686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa122b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e524b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0656600>]}
[0m08:50:06.741216 [debug] [MainThread]: Flushing usage events
[0m08:50:13.861509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cdc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71e20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f19850>]}


============================== 08:50:13.868128 | 417aedab-41c3-4a1c-b4c2-876d404cc9a8 ==============================
[0m08:50:13.868128 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:50:13.868620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:50:13.861507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3e2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4b9b50>]}


============================== 08:50:13.869365 | b345f8be-48ed-4fab-b688-1d2b88184505 ==============================
[0m08:50:13.869365 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:50:13.869999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:50:14.019113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6043080>]}
[0m08:50:14.019113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2bee40>]}
[0m08:50:14.058466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60678f0>]}
[0m08:50:14.059429 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:50:14.060836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b215dc0>]}
[0m08:50:14.062715 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:50:14.140794 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:50:14.142060 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:50:14.245704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:14.245920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:14.246476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:14.246535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:14.268963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60b8b60>]}
[0m08:50:14.272350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a153f80>]}
[0m08:50:14.369849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5eb99a0>]}
[0m08:50:14.373727 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:50:14.375338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73661e0>]}
[0m08:50:14.377402 [info ] [MainThread]: 
[0m08:50:14.378100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:50:14.381190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:50:14.381163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a07c5f0>]}
[0m08:50:14.381929 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:50:14.382653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a178a70>]}
[0m08:50:14.386447 [info ] [MainThread]: 
[0m08:50:14.389026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:50:14.393459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:50:14.417085 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:50:14.417677 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:50:14.418297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:14.429767 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:50:14.430497 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:50:14.430890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:14.432155 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m08:50:14.433462 [debug] [ThreadPool]: On list_airflow: Close
[0m08:50:14.436023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_trusted)
[0m08:50:14.436400 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m08:50:14.438621 [debug] [ThreadPool]: On list_airflow: Close
[0m08:50:14.441005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_driven_staging)
[0m08:50:14.441036 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:14.441810 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m08:50:14.442365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:14.444954 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:14.445311 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m08:50:14.445738 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m08:50:14.445807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:14.446047 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:14.446327 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m08:50:14.448962 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m08:50:14.449130 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m08:50:14.449343 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:14.449675 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m08:50:14.450330 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m08:50:14.450825 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m08:50:14.451330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now list_airflow_driven_staging)
[0m08:50:14.451712 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m08:50:14.453064 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:14.453327 [debug] [ThreadPool]: On list_airflow_driven_staging: BEGIN
[0m08:50:14.453295 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m08:50:14.453604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:14.453953 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m08:50:14.454492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now list_airflow_driven_trusted)
[0m08:50:14.457768 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:14.458099 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:50:14.458241 [debug] [ThreadPool]: On list_airflow_driven_trusted: BEGIN
[0m08:50:14.458462 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_staging"
[0m08:50:14.458723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:14.458781 [debug] [ThreadPool]: On list_airflow_driven_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_staging'
  
[0m08:50:14.460318 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.001 seconds
[0m08:50:14.461220 [debug] [ThreadPool]: On list_airflow_driven_staging: ROLLBACK
[0m08:50:14.461604 [debug] [ThreadPool]: On list_airflow_driven_staging: Close
[0m08:50:14.461571 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m08:50:14.462016 [debug] [ThreadPool]: Using postgres connection "list_airflow_driven_trusted"
[0m08:50:14.462474 [debug] [ThreadPool]: On list_airflow_driven_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_driven_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'driven_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'driven_trusted'
  
[0m08:50:14.464921 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.465210 [debug] [MainThread]: On master: BEGIN
[0m08:50:14.465434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:14.466792 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m08:50:14.467459 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m08:50:14.467753 [debug] [ThreadPool]: On list_airflow_driven_trusted: ROLLBACK
[0m08:50:14.467790 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.468096 [debug] [ThreadPool]: On list_airflow_driven_trusted: Close
[0m08:50:14.468122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:50:14.471078 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:50:14.471418 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.471680 [debug] [MainThread]: On master: BEGIN
[0m08:50:14.471904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:50:14.472249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f30e30>]}
[0m08:50:14.472777 [debug] [MainThread]: On master: ROLLBACK
[0m08:50:14.473050 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.473287 [debug] [MainThread]: On master: BEGIN
[0m08:50:14.473716 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:50:14.474096 [debug] [MainThread]: On master: COMMIT
[0m08:50:14.474377 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m08:50:14.474719 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.474954 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.475162 [debug] [MainThread]: On master: COMMIT
[0m08:50:14.475502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:50:14.475865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:14.476239 [debug] [MainThread]: On master: Close
[0m08:50:14.476991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:14.477607 [info ] [MainThread]: 
[0m08:50:14.479590 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:50:14.484350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ffe150>]}
[0m08:50:14.484834 [debug] [MainThread]: On master: ROLLBACK
[0m08:50:14.485169 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:14.485676 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m08:50:14.485735 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.486226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_staging, now model.dbt_driven_data.trusted_non_pii_data)
[0m08:50:14.486364 [debug] [MainThread]: On master: BEGIN
[0m08:50:14.486533 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:14.486965 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:50:14.487362 [debug] [MainThread]: On master: COMMIT
[0m08:50:14.487883 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:14.488087 [debug] [MainThread]: On master: COMMIT
[0m08:50:14.488383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:14.488630 [debug] [MainThread]: On master: Close
[0m08:50:14.489086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:14.491008 [info ] [MainThread]: 
[0m08:50:14.493199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.495187 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:14.514479 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:14.553499 [info ] [Thread-1 (]: 1 of 4 START sql table model driven_trusted.non_pii_data ....................... [RUN]
[0m08:50:14.555362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_driven_trusted, now model.dbt_driven_data.trusted_non_pii_data)
[0m08:50:14.567109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.563591 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:14.586270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.615366 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.607747 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m08:50:14.640067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:14.642814 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:14.695790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m08:50:14.698193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.703891 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
'***MASKED***' AS person_name,
SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
SUBSTRING(dp.email, 1, 5) || '*****' AS email,
'***MASKED***' AS personal_number,
'***MASKED***' AS birth_date,
'***MASKED***' AS address,
'***MASKED***' AS phone,
SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:14.705149 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.716384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.720296 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: BEGIN
[0m08:50:14.721118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:14.748708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m08:50:14.763722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.764515 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
'***MASKED***' AS person_name,
SUBSTRING(dp.user_name, 1, 5) || '*****' user_name,
SUBSTRING(dp.email, 1, 5) || '*****' AS email,
'***MASKED***' AS personal_number,
'***MASKED***' AS birth_date,
'***MASKED***' AS address,
'***MASKED***' AS phone,
SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:14.856187 [debug] [Thread-1 (]: SQL status: SELECT 11072 in 0.145 seconds
[0m08:50:14.884222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.886000 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m08:50:14.889771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:50:14.900852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.901918 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m08:50:14.904553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:50:14.940551 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:50:14.942432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.943535 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:50:14.952587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:50:14.959183 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m08:50:14.964420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:14.965076 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m08:50:14.971090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m08:50:14.975835 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m08:50:14.978310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa86e5a30>]}
[0m08:50:14.980460 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 11072[0m in 0.49s]
[0m08:50:14.984910 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:14.987600 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m08:50:14.990610 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m08:50:14.991253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m08:50:14.991646 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m08:50:14.994462 [debug] [Thread-1 (]: SQL status: SELECT 11072 in 0.228 seconds
[0m08:50:14.996008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m08:50:14.998705 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m08:50:15.003844 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.006904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.007297 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m08:50:15.008259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:15.015923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:15.016790 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m08:50:15.016951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:50:15.018306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.018395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:50:15.018739 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
df.iban,
fnu.download_speed,
fnu.upload_speed,
fnu.session_duration,
fnu.consumed_traffic,
((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_finance" df
ON
fnu.unique_id = df.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:15.021869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:15.022612 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
alter table "airflow"."driven_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m08:50:15.022921 [debug] [Thread-1 (]: SQL status: SELECT 1384 in 0.003 seconds
[0m08:50:15.024856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:50:15.026121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.026693 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m08:50:15.027179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.029293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.029667 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m08:50:15.031216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:50:15.032325 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:50:15.032572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.032836 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:50:15.034789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:50:15.037217 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m08:50:15.038631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.039506 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m08:50:15.041796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m08:50:15.043131 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m08:50:15.043658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fa8470>]}
[0m08:50:15.043673 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:50:15.045079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:15.044362 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 1384[0m in 0.05s]
[0m08:50:15.045384 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: COMMIT
[0m08:50:15.045739 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m08:50:15.046229 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.046823 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m08:50:15.047459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m08:50:15.047742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:50:15.047900 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.051380 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.052108 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.052150 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."non_pii_data__dbt_backup"
[0m08:50:15.054132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.055978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.056516 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m08:50:15.057176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:15.059246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_non_pii_data"
[0m08:50:15.059771 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_non_pii_data"} */
drop table if exists "airflow"."driven_trusted"."non_pii_data__dbt_backup" cascade
[0m08:50:15.061628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:15.062716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:50:15.065956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.067266 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
dp.person_name,
dp.user_name,
dp.email,
dp.personal_number,
dp.birth_date,
da.address,
dp.phone,
da.mac_address,
da.ip_address,
df.iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:15.070972 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_non_pii_data: Close
[0m08:50:15.073515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8edf10>]}
[0m08:50:15.075192 [info ] [Thread-1 (]: 1 of 4 OK created sql table model driven_trusted.non_pii_data .................. [[32mSELECT 11072[0m in 0.52s]
[0m08:50:15.076441 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_non_pii_data
[0m08:50:15.076962 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_payment_data
[0m08:50:15.077694 [info ] [Thread-1 (]: 2 of 4 START sql table model driven_trusted.payment_data ....................... [RUN]
[0m08:50:15.078343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_non_pii_data, now model.dbt_driven_data.trusted_payment_data)
[0m08:50:15.078647 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_payment_data
[0m08:50:15.081483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.084242 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_payment_data
[0m08:50:15.087418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.092555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.093046 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: BEGIN
[0m08:50:15.093470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:15.097008 [debug] [Thread-1 (]: SQL status: SELECT 11072 in 0.027 seconds
[0m08:50:15.097172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:50:15.097920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.098206 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */

  
    

  create  table "airflow"."driven_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
df.iban,
fnu.download_speed,
fnu.upload_speed,
fnu.session_duration,
fnu.consumed_traffic,
((fnu.download_speed + fnu.upload_speed + 1)/2) +
(fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_finance" df
ON
fnu.unique_id = df.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:15.099953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.100272 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m08:50:15.100658 [debug] [Thread-1 (]: SQL status: SELECT 1384 in 0.002 seconds
[0m08:50:15.102165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.102570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.102896 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m08:50:15.103478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.104263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.104509 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m08:50:15.104900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.105192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.105397 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
alter table "airflow"."driven_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m08:50:15.105716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.105958 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:50:15.106808 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:50:15.107042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.107067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.107299 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:50:15.107326 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: COMMIT
[0m08:50:15.118058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m08:50:15.118058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m08:50:15.122040 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."payment_data__dbt_backup"
[0m08:50:15.122051 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m08:50:15.122552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_payment_data"
[0m08:50:15.122830 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_payment_data"} */
drop table if exists "airflow"."driven_trusted"."payment_data__dbt_backup" cascade
[0m08:50:15.123070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.123501 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m08:50:15.124437 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:15.124823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:15.125473 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_payment_data: Close
[0m08:50:15.125930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9927eea0>]}
[0m08:50:15.127123 [info ] [Thread-1 (]: 2 of 4 OK created sql table model driven_trusted.payment_data .................. [[32mSELECT 1384[0m in 0.05s]
[0m08:50:15.126445 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m08:50:15.128158 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_payment_data
[0m08:50:15.128687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4fbf020>]}
[0m08:50:15.129127 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.129870 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 11072[0m in 0.08s]
[0m08:50:15.130073 [info ] [Thread-1 (]: 3 of 4 START sql table model driven_trusted.pii_data ........................... [RUN]
[0m08:50:15.130699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_payment_data, now model.dbt_driven_data.trusted_pii_data)
[0m08:50:15.130729 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.131013 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.131330 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.133999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.134327 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m08:50:15.134721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m08:50:15.134892 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.135123 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.137472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.137584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.138435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.138685 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.138689 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: BEGIN
[0m08:50:15.140672 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.140916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:15.141634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.142058 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m08:50:15.142395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:15.144349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:50:15.145276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.145671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:50:15.146203 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */

  
    

  create  table "airflow"."driven_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
dp.person_name,
dp.user_name,
dp.email,
dp.personal_number,
dp.birth_date,
da.address,
dp.phone,
da.mac_address,
da.ip_address,
df.iban,
dd.accessed_at,
fnu.session_duration,
fnu.download_speed,
fnu.upload_speed,
fnu.consumed_traffic,
fnu.unique_id
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
INNER JOIN
"airflow"."driven_staging"."dim_address" da ON
fnu.unique_id = da.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_date" dd ON da.unique_id =
dd.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_finance" df ON dd.unique_id
= df.unique_id
INNER JOIN
"airflow"."driven_staging"."dim_person" dp ON df.unique_id
= dp.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:15.146676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.147216 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
da.address,
da.mac_address,
da.ip_address,
fnu.download_speed,
fnu.upload_speed,
ROUND((fnu.session_duration/60), 1) as min_session_duration,
CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
ELSE false
END AS technical_issue
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_address" da
ON
fnu.unique_id = da.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:15.153746 [debug] [Thread-1 (]: SQL status: SELECT 1384 in 0.006 seconds
[0m08:50:15.156030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.156328 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m08:50:15.156826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.158737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.159294 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m08:50:15.160604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:50:15.161734 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:50:15.162053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.162263 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:50:15.165481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:50:15.167077 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m08:50:15.167504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.167925 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m08:50:15.174091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m08:50:15.175546 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m08:50:15.175598 [debug] [Thread-1 (]: SQL status: SELECT 11072 in 0.028 seconds
[0m08:50:15.176074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '417aedab-41c3-4a1c-b4c2-876d404cc9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa506d3d0>]}
[0m08:50:15.176607 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 1384[0m in 0.04s]
[0m08:50:15.177059 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.178693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.179207 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m08:50:15.180620 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:15.182536 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.182874 [debug] [MainThread]: On master: BEGIN
[0m08:50:15.184728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.184972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:15.185249 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
alter table "airflow"."driven_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m08:50:15.187312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.188178 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:50:15.188537 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:50:15.188814 [debug] [MainThread]: On master: COMMIT
[0m08:50:15.189010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.189236 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:15.189280 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: COMMIT
[0m08:50:15.189470 [debug] [MainThread]: On master: COMMIT
[0m08:50:15.189794 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:15.190136 [debug] [MainThread]: On master: Close
[0m08:50:15.190841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:15.191052 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m08:50:15.191119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:50:15.191661 [info ] [MainThread]: 
[0m08:50:15.192886 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."pii_data__dbt_backup"
[0m08:50:15.193178 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m08:50:15.193438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_pii_data"
[0m08:50:15.193841 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_pii_data"} */
drop table if exists "airflow"."driven_trusted"."pii_data__dbt_backup" cascade
[0m08:50:15.194213 [debug] [MainThread]: Command end result
[0m08:50:15.195553 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:15.196589 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_pii_data: Close
[0m08:50:15.197068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991bd790>]}
[0m08:50:15.197739 [info ] [Thread-1 (]: 3 of 4 OK created sql table model driven_trusted.pii_data ...................... [[32mSELECT 11072[0m in 0.07s]
[0m08:50:15.199519 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_pii_data
[0m08:50:15.199839 [debug] [Thread-1 (]: Began running node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.200181 [info ] [Thread-1 (]: 4 of 4 START sql table model driven_trusted.technical_data ..................... [RUN]
[0m08:50:15.200684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_driven_data.trusted_pii_data, now model.dbt_driven_data.trusted_technical_data)
[0m08:50:15.200947 [debug] [Thread-1 (]: Began compiling node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.203113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.203794 [debug] [Thread-1 (]: Began executing node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.205717 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.206863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.207081 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: BEGIN
[0m08:50:15.207293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:15.209666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m08:50:15.209900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.210186 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */

  
    

  create  table "airflow"."driven_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    
WITH source_data AS (
SELECT
fnu.unique_id,
da.address,
da.mac_address,
da.ip_address,
fnu.download_speed,
fnu.upload_speed,
ROUND((fnu.session_duration/60), 1) as min_session_duration,
CASE
WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR
fnu.session_duration/60 < 1 THEN true
ELSE false
END AS technical_issue
FROM
"airflow"."driven_staging"."fact_network_usage" fnu
JOIN
"airflow"."driven_staging"."dim_address" da
ON
fnu.unique_id = da.unique_id
)
SELECT
*
FROM
source_data
  );
  
[0m08:50:15.213441 [debug] [Thread-1 (]: SQL status: SELECT 1384 in 0.003 seconds
[0m08:50:15.215958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.217969 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m08:50:15.219761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.223540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.224093 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
alter table "airflow"."driven_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m08:50:15.224629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:50:15.226131 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:50:15.226466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.226777 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: COMMIT
[0m08:50:15.227658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:50:15.229152 [debug] [Thread-1 (]: Applying DROP to: "airflow"."driven_trusted"."technical_data__dbt_backup"
[0m08:50:15.229665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_driven_data.trusted_technical_data"
[0m08:50:15.229929 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_driven_data.trusted_technical_data"} */
drop table if exists "airflow"."driven_trusted"."technical_data__dbt_backup" cascade
[0m08:50:15.229928 [info ] [MainThread]: 
[0m08:50:15.230877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:50:15.231326 [info ] [MainThread]: 
[0m08:50:15.231466 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:50:15.231811 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:50:15.232468 [debug] [Thread-1 (]: On model.dbt_driven_data.trusted_technical_data: Close
[0m08:50:15.233034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b345f8be-48ed-4fab-b688-1d2b88184505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9925bef0>]}
[0m08:50:15.234435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4811866, "process_user_time": 3.611253, "process_kernel_time": 0.66657, "process_mem_max_rss": "117836", "process_in_blocks": "33128", "process_out_blocks": "1845"}
[0m08:50:15.234949 [info ] [Thread-1 (]: 4 of 4 OK created sql table model driven_trusted.technical_data ................ [[32mSELECT 1384[0m in 0.03s]
[0m08:50:15.236166 [debug] [MainThread]: Command `dbt run` succeeded at 08:50:15.236001 after 1.48 seconds
[0m08:50:15.237193 [debug] [Thread-1 (]: Finished running node model.dbt_driven_data.trusted_technical_data
[0m08:50:15.237650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6cdbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5170950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ff3e30>]}
[0m08:50:15.238203 [debug] [MainThread]: Flushing usage events
[0m08:50:15.239712 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:15.240072 [debug] [MainThread]: On master: BEGIN
[0m08:50:15.240293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:50:15.244238 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:50:15.244830 [debug] [MainThread]: On master: COMMIT
[0m08:50:15.245410 [debug] [MainThread]: Using postgres connection "master"
[0m08:50:15.246050 [debug] [MainThread]: On master: COMMIT
[0m08:50:15.246562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:50:15.246994 [debug] [MainThread]: On master: Close
[0m08:50:15.247787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:15.248350 [debug] [MainThread]: Connection 'model.dbt_driven_data.trusted_technical_data' was properly closed.
[0m08:50:15.248902 [info ] [MainThread]: 
[0m08:50:15.249653 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m08:50:15.250627 [debug] [MainThread]: Command end result
[0m08:50:15.279353 [info ] [MainThread]: 
[0m08:50:15.280106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:50:15.280498 [info ] [MainThread]: 
[0m08:50:15.280934 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:50:15.282806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.527652, "process_user_time": 3.656265, "process_kernel_time": 0.697661, "process_mem_max_rss": "118056", "process_in_blocks": "24032", "process_out_blocks": "1845"}
[0m08:50:15.283636 [debug] [MainThread]: Command `dbt run` succeeded at 08:50:15.283526 after 1.53 seconds
[0m08:50:15.284189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf17b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b215ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9add86e0>]}
[0m08:50:15.284444 [debug] [MainThread]: Flushing usage events
